<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Mobile触摸页面</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <link rel="stylesheet" type="text/css" href="../css/font/iconfont.css" />
    <link rel="stylesheet" type="text/css" href="../css/mobileui.css" />
    <style>
    </style>

</head>

<body>
    <!--主体-->
    <div class="m-bd">

        <!--头部-->
        <header class="m-hd">
            <div class="m-hd-top">
                <div class="m-hd-top-icon  m-back">
                    <span class="iconfont icon-back-left "></span>
                </div>

                <h4 class="m-hd-top-ttl">router 路由组件</h4>
            </div>

        </header>

        <!--内容-->
        <section class="m-cnt">
            <button type="button" class="m-btn m-btn-primary  " id="router">路由加载html页</button>
        </section>

        <!--底部-->
        <footer class="m-ft">
            <div class="m-ft-nav">
                <h4 class="m-ft-nav-ttl">页脚</h4>
            </div>
        </footer>

    </div>

    <script src="../js/mobileui.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/m-router.js" type="text/javascript" charset="utf-8"></script>
 
    <script type="text/javascript">

        /*
        * 监听路由页面加载
        * */
        m.router.page({

            /* 设置当前路由页面的对象的参数 */
            setting: {
                routerTilte: "测试路由" // 路由页的标题
                // routerTilteColor: "red",  // 路由页的标题字体颜色
            },

            /*加载js的列表 */
            loadJs: [
                "../js/m-vd.js",
                "../js/cityData.js"
            ],
            // isAmd:true, /*默认为true异步加载js, isAmd=false同步加载js*/

            // 生命周期函数--监听页面显示
            onLoad: function (context) {
                // context 当前路由模块上下文对象
                console.log("onLoad", context);

                var vd1 = m.vd.create("#form1", context);
                // 始化验证对象
                vd1.init();
                //vd1.reset();  //重设表单并清空所以内容和检测验证

                // 检查验证=>vd1.check(el) 验证当前项;
                // 验证全部=>vd1.validate();

                // 点击提交验证
                $(".vd-btn", context).on("tap", function () {

                    // 是否验证成功
                    vd1.isSuccess(
                        // success
                        function (obj) {

                            vd1.reset();
                            $.mAlert(JSON.stringify(obj));

                        },
                        // error
                        function (obj) {

                            //console.log(obj);
                            $.mAlert(obj.errorMsg, function () { obj.el.focus(); });

                        });
                });

                // 发送验证码
                $(".vd-dep-btn", context).click(function () {

                    // 根据name属性获取对象
                    if (vd1.getObj("phone").bl) {

                        $.mInfo("已发送验证码");
                    };

                });

                m("#city", context).focus(function () {
                    m(this).blur();
                    $.mPicker({ type: "city1" }, function (val) {
                        m(this).val(val.city.city1.txt);
                        vd1.check(this);
                    }.bind(this));
                });

                m("#router", context).tap(function () {

                    m.router.link("./mr-test.html?name=hqs&&age=28");

                });

            },

            // 生命周期函数--监听页面显示
            onShow: function (context) {
                // context 当前路由模块上下文对
                console.log("onShow", context);
            },

            // 生命周期函数--监听页面隐藏
            onHide: function (context) {
                // context 当前路由模块上下文对
                console.log("onHide", context);
                m.router.app.page = (m.router.app.page - 1);

            },

        });

    </script>


</body>

</html>

